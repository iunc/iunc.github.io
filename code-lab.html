<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Code lab</title>

<style>
*{box-sizing:border-box}

body{
  margin:0;
  background:#0b0f14;
  color:white;
  font-family:monospace;
  height:100vh;
  display:flex;
  flex-direction:column;
  overflow:hidden;
}
  
.topbar{
  height:50px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 15px;
  background:#111827;
  border-bottom:1px solid #1f2937;
}

.topbar button{
  background:#1f2937;
  border:none;
  color:#38bdf8;
  padding:6px 12px;
  border-radius:8px;
}

.tabs{
  display:flex;
  height:40px;
  background:#0f172a;
}

.tabs button{
  flex:1;
  border:none;
  background:none;
  color:#94a3b8;
  font-weight:bold;
}

.tabs button.active{
  color:#38bdf8;
  border-bottom:2px solid #38bdf8;
}

.editor{
  height:38%;
  background:#0b0f14;
}

textarea{
  width:100%;
  height:100%;
  border:none;
  resize:none;
  padding:12px;
  background:#0b0f14;
  color:#00ff88;
  font-size:14px;
  overflow:auto;
}
  
.preview{
  flex:1;
  display:flex;
  flex-direction:column;
  border-top:1px solid #1f2937;
}

iframe{
  flex:1;
  border:none;
  background:white;
}

.console{
  height:90px;
  background:#000;
  color:#00ff88;
  padding:8px;
  overflow:auto;
  font-size:12px;
  border-top:1px solid #1f2937;
}
  .title{
  cursor:pointer;
  font-weight:bold;
  font-size: 15px;
  letter-spacing:1px;
  color:#38bdf8;
}

.title:active{
  opacity:0.6;
}
  
.control-bar{
  height:20px;
  display:flex;
  justify-content:space-around;
  align-items:center;
  background:#111827;
  border-top:1px solid #1f2937;
  border-bottom:1px solid #1f2937;
}

.control-bar button{
  background:none;
  border:none;
  color:#38bdf8;
  font-size:18px;
  cursor:pointer;
  transition:0.15s;
}

.control-bar button:active{
  transform:scale(0.9);
  opacity:0.6;
}
</style>
</head>

<body>

<div class="topbar">
  <button onclick="location.href='dashboard.html'" style="font-weight: bold"> â—€ Back</button>
  <div class="title" onclick="reloadPage()">CODE LAB</div>
  <button style="font-weight: bold">Go â–¶</button>
</div>

<div class="tabs">
  <button id="btn-html" class="active" onclick="switchTab('html')">HTML</button>
  <button id="btn-css" onclick="switchTab('css')">CSS</button>
  <button id="btn-js" onclick="switchTab('js')">JS</button>
</div>

<div class="editor">
  <textarea id="html"></textarea>
  <textarea id="css" style="display:none"></textarea>
  <textarea id="js" style="display:none"></textarea>
</div>

<div class="control-bar">
  <button onclick="newProject()">ðŸ†•New</button>
  <button onclick="copyCode()">ðŸ“‹Copy</button>
  <button onclick="runCode()">Runâ–¶</button>
  <button onclick="reloadPreview()">âŸ³Reload</button>
</div>
  
<div class="preview">
  <iframe id="preview"></iframe>
  <div class="console" id="console"></div>
</div>

<script>
let autoRun;

function switchTab(tab){
  ["html","css","js"].forEach(id=>{
    document.getElementById(id).style.display="none";
    document.getElementById("btn-"+id).classList.remove("active");
  });
  document.getElementById(tab).style.display="block";
  document.getElementById("btn-"+tab).classList.add("active");
}

function runCode(){
  const html = htmlEl.value;
  const css = cssEl.value;
  const js = jsEl.value;

  const output = `
  <html>
  <head><style>${css}</style></head>
  <body>
  ${html}
  <script>
  const log = (...a)=>parent.postMessage({type:'log',data:a.join(" ")},'*');
  console.log = log;
  try{ ${js} }catch(e){ log("Error: "+e.message) }
  <\/script>
  </body>
  </html>
  `;

  consoleBox.innerHTML="";
  preview.srcdoc = output;
}

window.addEventListener("message",(e)=>{
  if(e.data.type==="log"){
    consoleBox.innerHTML += e.data.data+"<br>";
    consoleBox.scrollTop = consoleBox.scrollHeight;
  }
});

const htmlEl = document.getElementById("html");
const cssEl = document.getElementById("css");
const jsEl = document.getElementById("js");
const preview = document.getElementById("preview");
const consoleBox = document.getElementById("console");

[htmlEl,cssEl,jsEl].forEach(el=>{
  el.addEventListener("input",()=>{
    clearTimeout(autoRun);
    autoRun=setTimeout(runCode,800);
  });
});
  
function reloadPage(){
  location.reload();
}

function copyCode(){
  const activeTab =
    htmlEl.style.display !== "none" ? htmlEl :
    cssEl.style.display !== "none" ? cssEl :
    jsEl;
  navigator.clipboard.writeText(activeTab.value);
}
</script>

</body>
</html>
